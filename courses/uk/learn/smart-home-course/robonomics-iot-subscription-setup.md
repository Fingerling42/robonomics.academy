---
title: "Урок №5, Налаштування підписки Robonomics IoT"
lastUpdate: Thu May 18 2023 10:46:29 GMT+0400 (Samara Standard Time)
description: курс домашнього асистента
lessonNumber: 6
metaOptions: [Вивчайте, Суверенний Розумний Дім з Robonomics та Домашнім Асистентом]
defaultName: Sovereign Smart Home with Robonomics and Home Assistant
---


## Про що йдеться

Підписка Robonomics IoT дозволяє користувачам використовувати всі функції парачейну протягом певного періоду без сплати стандартних транзакційних витрат. Активуючи підписку, пристрої зможуть відправляти транзакції з пріоритетом.

У цьому уроці ви створите необхідні облікові записи для безпечності розумного дому та придбаєте підписку IoT.

## Теорія

Підписка IoT, а також метод її придбання та управління, реалізовані за допомогою палітри <code>rws</code>, яка містить всі необхідні функції. Загалом, підписки в Robonomics продаються за моделлю аукціону, яка використовує зовнішній виклик <code>rws.startAuction()</code> для створення аукціону для певного ідентифікатора підписки. ористувачі можуть отримати доступ до аукціону за допомогою ідентифікатора та робити ставки за допомогою зовнішнього виклику <code>rws.bid()</code>.

Після завершення аукціону адреса з переможною ставкою призначається підписці. Тепер ця адреса зможе відправляти транзакції через зовнішній виклик <code>rws.call()</code> без витрат. Однак це не означає, що адреса може це робити безконтрольно у будь-який час: кожна підписка має певну кількість значення <code>weight</code>, яке повинно накопичуватися перед виконанням безкоштовної транзакції. Деяка кількість значення <code>weight</code> додається до підписки кожен блок, що генерується в парачейні, завдяки цьому Robonomics регулює пропускну здатність парачейну.

Крім того, власник підписки може використовувати зовнішній виклик <code>rws.setDevices()</code>, який розподіляє використання підписки на вказані адреси. У той же час <code>weight</code> залишається незмінним, тому чим більше адрес у підписці, тим довше кожен з них буде чекати перед відправленням безкоштовної транзакції.

Для управління Home Assistant за допомогою Robonomics вам потрібно два облікові записи на парачейні Robonomics. Ці облікові записи забезпечать безпеку вашому Home Assistant.

З одним з облікових записів (<code>SUB_OWNER</code>) ви придбаєте підписку Robonomics. Цей обліковий запис діє як головний адміністратор підписки IoT та надає доступ до Home Assistant іншим користувачам (за допомогою <code>rws.setDevices()</code>). Цей обліковий запис повинен мати певну кількість токенів XRT для завершення транзакцій покупки підписки.

Другий обліковий запис (<code>SUB_CONTROLLER</code>) бде контролювати всі процеси Home Assistant пристроїв (такі як телеметрія). Транзакції ваших пристроїв будуть відправлятися від імені облікового запису <code>SUB_CONTROLLER</code>. Ви (і будь-хто) зможете бачити ці транзакції в будь-якому досліднику парачейну, наприклад [Subscan](https://robonomics.subscan.io/). Однак тільки ви зможете розшифрувати вміст цих транзакцій, якщо володієте необхідними секретними фразами.

## Інструкції

<List type="numbers">

<li>

Створення облікових записів власника та контролера парачейну

<List>

<li>

<robo-academy-note type="warning" title="WARNING">
Обидва облікових записи повинні бути створені з шифруванням ed25519.
</robo-academy-note>

</li>

<li>

Перейдіть на [додаток парачейну Robonomics](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/) на порталі Polkadot / Substrate. Перевірте верхній лівий кут, щоб переконатися, що ви підключені до парачейну Robonomics.

</li>

<li>

Через використання формату *ed25519* вам потрібно створити обліковий запис за допомогою Polkadot-JS UI та вибрати необхідне шифрування. 

Ця функція за замовчуванням вимкнена в Polkadot-JS UI. Щоб увімкнути її, перейдіть до <code>Налаштування</code> -> <code>Загальне</code> -> <code>опції облікового запису</code> та виберіть <code>Дозволити локальне зберігання облікового запису в браузері</code> у розкривному меню <code>створення облікового запису в браузері</code>.
 
</li>

<li>

Перейдіть до <code>Облікові записи</code> -> <code>Облікові записи</code> та натисніть кнопку <code>Додати обліковий запис</code>. Ви побачите спливаюче меню з насінням облікового запису. Воно має дві форми: *Мнемонічний* (людиночитаний) та *Сирий* (послідовність цифр і літер).

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmQiJYPYajUJXENX2PzSJMSKGSshyWyPNqugSYxP5eCNvm', type:'mp4'}]" />

</li>

<li>

Відкрийте <code>Розширені параметри створення</code>, змініть тип криптографії створення облікового запису на <code>Едвардс - ed25519</code>. Збережіть мнемонічну фразу насіння безпечно та натисніть <code>Далі</code>.

</li>

<li>

У наступному меню вам потрібно встановити ім'я облікового запису та пароль. Дайте йому ім'я <code>SUB_OWNER</code> для зручності та натисніть <code>Далі</code>.

</li>

<li>

На останньому вікні натисніть <code>Зберегти</code>, щоб завершити створення облікового запису. Він також згенерує резервні JSON-файли, які вам слід безпечно зберігати. Пізніше ви можете використовувати цей файл для відновлення облікового запису, якщо ви запам'ятаєте пароль.

</li>

<li>

Повторіть ці кроки для облікового запису <code>SUB_CONTROLLER</code>.

</li>
</List>
</li>

<li>

Додавання облікових записів до розширення Polkadot.js

<List type="numbers">

<li>

Для зручності використовуйте розширення Polkadot.js та додайте ці нові створені облікові записи до нього. Для облікового запису ed25519 ви можете це зробити лише за допомогою резервного файлу JSON. Ви можете використовувати файли, збережені при створенні облікових записів.

Ви можете отримати ці файли знову, створивши резервну копію облікового запису. Натисніть на три крапки на своєму обліковому записі, виберіть <code>Створити резервну копію для цього облікового запису</code> та введіть свій пароль.

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmRd7gztUjWkLF4W2XuJwy5aXBwzNV2aPCU6CQQLvUpSNj', type:'mp4'}]" />

</li>

<li>

Відкрийте розширення та натисніть кнопку <code>+</code> у верхньому правому куті, потім виберіть <code>Відновити обліковий запис з резервного файлу JSON</code>.

</li>

<li>

У відкритому вікні завантажте файл JSON, введіть парол та натисніть <code>Відновити</code>

</li>

<li>

Переконайтеся, що для облікових записів у розширенні Polkadot.js вибрана мережа Robonomics. На порталі Polkadot / Substrate перейдіть до <code>Налаштування</code> -> <code>Метадані</code> та натисніть на кнопку <code>Оновити метадані</code>. 

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmT5sTNP9t8gpbD4RJJw6ETwG4wiziiChAh2uHHBk9Zsyd', type:'mp4'}]" />

</li>

<li>

Підтвердіть оновлення метаданих у спливаючому вікні. Тепер розширення покаже мітку мережі, для якої використовується адреса.

</li>

</List>
</li>

<li>

Активація підписки Robonomics

<List >

<li>

<robo-academy-note type="okay">
Для цього кроку вам потрібно мати достатню кількість токенів XRT (мінімум 2-3 XRT) на вашому обліковому записі <code>SUB_OWNER</code>.
</robo-academy-note>

Перейдіть до додатку Robonomics на [сторінку підписки](https://dapp.robonomics.network/#/subscription) та натисніть <code>підключити обліковий запис</code> у бічній панелі справа.

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmXrFCajmJgkRDSbshGD3QehjnoyS6jafEPSjHdYkoBHum', type:'mp4'}]" />

</li>

<li>

У наступному спливаючому меню підключіть розширення Polkadot.js. Ви побачите адресу свого облікового запису з балансом.

</li>

<li>

Перш ніж здійснити покупку, переконайтеся, що ви вибрали обліковий запис <code>SUB_OWNER</code>. Натисніть на значок профілю адреси, ви повинні побачити обліковий запис <code>SUB_OWNER</code> під полем <code>Перевірити власника облікового запису</code>.

</li>

<li>

Нарешті, натисніть кнопку <code>ПОДАТИ</code> та введіть пароль для свого облікового запису. Після цього зачекайте, поки завершиться процес активації. Через деякий час ви побачите стан вашої підписки.

Якщо доступні жодні підписки, **будь ласка, зв'яжіться** з командою Robonomics.

</li>
</List>
</li>

<li>

Додавання облікового запису до підписки

<List type="numbers">

<li>

Тепер вам потрібно додати обліковий запис <code>SUB_CONTROLLER</code> до **списку доступу**. Відкрийте розширення та натисніть на значок біля назви облікового запису. Він скопіює адресу облікового запису.

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmV1gkwtcXsWv54ov9tuXfcHg7nqs1foM8cRwts4sqnqtX', type:'mp4'}]" />

</li>

<li>

Вставте цю адресу в поле <code>Адреса паралельної мережі Robonomics</code> в частині **Керування доступом**.

Дайте йому назву та натисніть кнопку <code>+</code>. Введіть свій пароль <code>SUB_OWNER</code> у спливаючому вікні та зачекайте, поки завершиться процес активації.

</li>

<li>

Повторіть кроки для облікового запису <code>SUB_OWNER</code>.
</li>
</List>
</li>
</List>