---
title: "Урок №5, Настройка подписки Robonomics IoT"
lastUpdate: Thu May 18 2023 10:46:29 GMT+0400 (Samara Standard Time)
description: курс домашнего помощника
lessonNumber: 6
metaOptions: [Изучите суверенный умный дом с помощью Robonomics и Home Assistant]
defaultName: Sovereign Smart Home with Robonomics and Home Assistant
---


## О чем это

Подписка Robonomics IoT позволяет пользователям использовать все функции парачейна в течение определенного периода без уплаты стандартных комиссий за транзакции. Активируя подписку, устройства смогут отправлять транзакции с приоритетом.

На этом уроке вы создадите необходимые учетные записи безопасности умного дома и приобретете подписку IoT.

## Теория

Подписка IoT, а также способ ее приобретения и управления, реализованы с использованием паллета <code>rws</code>, который содержит все необходимые функции. В общем, подписки в Robonomics продаются по модели аукциона, который использует экструзию <code>rws.startAuction()</code> для создания аукциона для определенного идентификатора подписки. Пользователи могут получить доступ к аукциону по идентификатору и делать ставки с использованием экструзии <code>rws.bid()</code>.

По окончании аукциона адресу с победной ставкой назначается подписка. Теперь этот адрес сможет отправлять транзакции через экструзию <code>rws.call()</code> без комиссий. Однако это не означает, что адрес может делать это без контроля в любое время: у каждой подписки есть определенное количество значения <code>weight</code>, которое должно накапливаться перед выполнением бесплатной транзакции. Некоторое значение <code>weight</code> добавляется к подписке каждый сгенерированный блок в парачейне, благодаря этому Robonomics регулирует пропускную способность парачейна.

Кроме того, владелец подписки может использовать экструзию <code>rws.setDevices()</code>, которая делит использование подписки на указанные адреса. При этом <code>weight</code> остается прежним, поэтому чем больше адресов в подписке, тем дольше каждому из них придется ждать перед отправкой бесплатной транзакции.

Для управления Home Assistant с помощью Robonomics вам понадобятся две учетные записи на парачейне Robonomics. Эти учетные записи обеспечат безопасность вашему Home Assistant.

С одной из учетных записей (<code>SUB_OWNER</code>) вы купите подписку Robonomics. Эта учетная запись действует как основной администратор подписки IoT и предоставляет доступ к Home Assistant другим пользователям (с использованием <code>rws.setDevices()</code>). У этой учетной записи должны быть некоторые токены XRT для завершения транзакций покупки подписки.

Вторая учетная запись (<code>SUB_CONTROLLER</code>) будет контролировать все процессы Home Assistant устройств (например, телеметрию). Транзакции ваших устройств будут отправляться от имени учетной записи <code>SUB_CONTROLLER</code>. Вы (и любой) сможете видеть эти транзакции в любом исследователе парачейна, таком как [Subscan](https://robonomics.subscan.io/). Однако только вы сможете расшифровать содержимое этих транзакций, пока вы надежно обладаете необходимыми фразами-семенами.

## Инструкции

<List type="numbers">

<li>

Создание учетных записей владельца и контроллера парачейна

<List>

<li>

<robo-academy-note type="warning" title="WARNING">
Обе учетные записи должны быть созданы с шифрованием ed25519.
</robo-academy-note>

</li>

<li>

Перейдите на [приложение Robonomics Parachain](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/) на портале Polkadot / Substrate. Проверьте верхний левый угол, чтобы убедиться, что вы подключены к парачейну Robonomics.

</li>

<li>

Используя формат *ed25519*, вам необходимо создать учетную запись с помощью Polkadot-JS UI и выбрать необходимое шифрование. 

Эта функция по умолчанию отключена в Polkadot-JS UI. Чтобы включить ее, перейдите к <code>Настройки</code> -> <code>Общие</code> -> <code>опции учетной записи</code> и выберите <code>Разрешить локальное хранение учетной записи в браузере</code> в выпадающем меню <code>создание учетной записи в браузере</code>.
 
</li>

<li>

Перейдите к <code>Учетные записи</code> -> <code>Учетные записи</code> и нажмите кнопку <code>Добавить учетную запись</code>. Вы увидите всплывающее меню с семенем учетной записи. Оно имеет две формы: *Мнемоника* (читаемая человеком) и *Сырой* (последовательность цифр и букв).

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmQiJYPYajUJXENX2PzSJMSKGSshyWyPNqugSYxP5eCNvm', type:'mp4'}]" />

</li>

<li>

Откройте <code>Дополнительные параметры создания</code>, измените тип криптографии создания учетной записи на <code>Эдвардс - ed25519</code>. Сохраните мнемоническую фразу семени безопасно и нажмите <code>Далее</code>.

</li>

<li>

В следующем меню вам необходимо задать имя учетной записи и пароль. Дайте ему имя <code>SUB_OWNER</code> для удобства и нажмите <code>Далее</code>.

</li>

<li>

На последнем окне нажмите <code>Сохранить</code>, чтобы завершить создание учетной записи. Он также сгенерирует резервные JSON-файлы, которые вы должны безопасно хранить. Позже вы сможете использовать этот файл для восстановления учетной записи, если помните пароль.

</li>

<li>

Повторите эти шаги для учетной записи <code>SUB_CONTROLLER</code>.

</li>
</List>
</li>

<li>

Добавление учетных записей в расширение Polkadot.js

<List type="numbers">

<li>

Для удобства вы должны использовать расширение Polkadot.js и добавить эти только что созданные учетные записи в него. Для учетной записи ed25519 вы можете сделать это только с помощью резервного JSON-файла. Вы можете использовать файлы, сохраненные при создании учетных записей.

Вы можете получить эти файлы снова, создав резервную копию учетной записи. Нажмите на три точки на своей учетной записи, выберите <code>Создать резервную копию для этой учетной записи</code> и введите свой пароль.

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmRd7gztUjWkLF4W2XuJwy5aXBwzNV2aPCU6CQQLvUpSNj', type:'mp4'}]" />

</li>

<li>

Откройте расширение и нажмите кнопку <code>+</code> в правом верхнем углу, затем выберите <code>Восстановить учетную запись из резервного JSON-файла</code>.

</li>

<li>

В открытом окне загрузите JSON-файл, введите пароль и нажмите <code>Восстановить</code>

</li>

<li>

Убедитесь, что для учетных записей в расширении Polkadot.js выбрана сеть Robonomics. На портале Polkadot / Substrate перейдите в <code>Настройки</code> -> <code>Метаданные</code> и нажмите на кнопку <code>Обновить метаданные</code>. 

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmT5sTNP9t8gpbD4RJJw6ETwG4wiziiChAh2uHHBk9Zsyd', type:'mp4'}]" />

</li>

<li>

Подтвердите обновление метаданных во всплывающем окне. Теперь расширение покажет метку сети, для которой используется адрес.

</li>

</List>
</li>

<li>

Активация подписки Robonomics

<List >

<li>

<robo-academy-note type="okay">
Для этого шага у вас должно быть достаточное количество токенов XRT (минимум 2-3 XRT) на вашем счете <code>SUB_OWNER</code>.
</robo-academy-note>

Перейдите на страницу подписки Robonomics dapp по ссылке [subscription page](https://dapp.robonomics.network/#/subscription) и нажмите <code>connect account</code> на боковой панели справа.

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmXrFCajmJgkRDSbshGD3QehjnoyS6jafEPSjHdYkoBHum', type:'mp4'}]" />

</li>

<li>

В следующем всплывающем меню подключите расширение Polkadot.js. Вы увидите адрес вашей учетной записи с балансом.

</li>

<li>

Перед покупкой убедитесь, что вы выбрали учетную запись <code>SUB_OWNER</code>. Нажмите на иконку профиля адреса, вы должны увидеть учетную запись <code>SUB_OWNER</code> под полем <code>Проверить учетную запись владельца</code>.

</li>

<li>

Наконец, нажмите кнопку <code>ПОДТВЕРДИТЬ</code> и введите пароль для вашей учетной записи. После этого дождитесь завершения процесса активации. Через некоторое время вы увидите состояние вашей подписки.

Если подписки недоступны, **пожалуйста, свяжитесь** с командой Robonomics.

</li>
</List>
</li>

<li>

Добавление учетной записи в подписку

<List type="numbers">

<li>

Теперь вам нужно добавить учетную запись <code>SUB_CONTROLLER</code> в **список доступа**. Откройте расширение и нажмите на иконку рядом с именем учетной записи. Он скопирует адрес учетной записи.

<LessonVideo  :videos="[{src: 'https://crustipfs.info/ipfs/QmV1gkwtcXsWv54ov9tuXfcHg7nqs1foM8cRwts4sqnqtX', type:'mp4'}]" />

</li>

<li>

Вставьте этот адрес в поле <code>Адрес парачейна Robonomics</code> в разделе **Управление доступом**.

Дайте ему имя и нажмите кнопку <code>+</code>. Введите пароль вашей учетной записи <code>SUB_OWNER</code> во всплывающем окне и дождитесь завершения процесса активации.

</li>

<li>

Повторите шаги для учетной записи <code>SUB_OWNER</code>.
</li>
</List>
</li>
</List>